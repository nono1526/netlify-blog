(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{33:function(t,a,e){"use strict";e.r(a);var s=e(3),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("template",{slot:"header"},[e("h1",{attrs:{id:"筆記-javascript-中的-plain-object"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#筆記-javascript-中的-plain-object","aria-hidden":"true"}},[t._v("#")]),t._v(" [筆記] Javascript 中的 Plain Object")])]),e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),e("p",[t._v("前陣子在看 Vue 源碼時，看到了 Vue 的 utils 有一個 "),e("code",[t._v("isPlainObject")]),t._v(" 的方法。")]),t._v(" "),e("p",[t._v("所以想說來一探 Javascript Plain Object，結果發現根本如泥沼一般啊 XD")]),t._v(" "),e("h2",{attrs:{id:"快速導覽"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#快速導覽","aria-hidden":"true"}},[t._v("#")]),t._v(" 快速導覽")]),t._v(" "),e("ul",[e("li",[t._v("JS Plain Object 定義\n"),e("ul",[e("li",[t._v("使用 typeof 來最初步的判斷")]),t._v(" "),e("li",[t._v("原形鍊判斷")]),t._v(" "),e("li",[t._v("Object.prototype.toString")])])])]),t._v(" "),e("h2",{attrs:{id:"js-plain-object-定義"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#js-plain-object-定義","aria-hidden":"true"}},[t._v("#")]),t._v(" JS Plain Object 定義")]),t._v(" "),e("p",[t._v("到底 Plain Object 是什麼呢？")]),t._v(" "),e("p",[t._v("上網查詢後的得到的結論眾說紛紜，每個人給出的答案都不盡相同。")]),t._v(" "),e("p",[t._v("以下兩個是常見 "),e("code",[t._v("isPlainObject")]),t._v(" 做法。")]),t._v(" "),e("ul",[e("li",[t._v("使用 typeof 來最初步的判斷")]),t._v(" "),e("li",[t._v("產生出來的 object 的 protype 要是 "),e("code",[t._v("Object.prototype")])]),t._v(" "),e("li",[t._v("透過 "),e("code",[t._v("Object.prototype.toString")]),t._v(" 得到 "),e("code",[t._v("[object {tag}]")])])]),t._v(" "),e("h3",{attrs:{id:"使用-typeof-來最初步的判斷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-typeof-來最初步的判斷","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用 typeof 來最初步的判斷")]),t._v(" "),e("p",[t._v("我們知道 JS 裡的一個眾所皆知的大笑話 "),e("code",[t._v("typeof null === 'object'")]),t._v("。")]),t._v(" "),e("p",[t._v("但其實 "),e("code",[t._v("typeof")]),t._v(" 還是滿有用的，能夠讓我們初步的判斷你的 Object 是不是真的長得像 Object XD。")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// lodash isObjectLike")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isObjectLike")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" value "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("但一直都沒有改掉這個，也許也永遠不會～")]),t._v(" "),e("h3",{attrs:{id:"產生出來的-object-的原形要是-object-prototype"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#產生出來的-object-的原形要是-object-prototype","aria-hidden":"true"}},[t._v("#")]),t._v(" 產生出來的 object 的原形要是 "),e("code",[t._v("Object.prototype")])]),t._v(" "),e("p",[t._v("最簡單的判斷 Plain Object 也就是只要是透過 "),e("code",[t._v("object iterator")]),t._v(" 也就是 "),e("code",[t._v("{}")]),t._v("，或是使用 "),e("code",[t._v("new Object")]),t._v(" 來產生的 object 都先統稱為 Plain Object。")]),t._v(" "),e("p",[t._v("如果是透過 function 建立的 object 我們就不稱他為 Plain Object。")]),t._v(" "),e("p",[t._v("範例")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Plain Object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foo "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bar "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Not Plain Object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Foobar")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foobar "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Foobar")]),t._v("\n")])])]),e("p",[t._v("到這邊簡單我們整理出基本款 isPlainObject 的做法，看看兩者差異就可以了。")]),t._v(" "),e("ul",[e("li",[t._v("Plain Object\n"),e("ul",[e("li",[t._v("foo、bar 的 "),e("code",[t._v("prototype")]),t._v(" 為 "),e("code",[t._v("Object.prototype")])]),t._v(" "),e("li",[t._v("foobar 的 "),e("code",[t._v("prototype")]),t._v(" 為 "),e("code",[t._v("Foobar.prototype")])])])])]),t._v(" "),e("p",[t._v("這邊我們透過 "),e("code",[t._v("Object.getPrototype")]),t._v(" 來找到物件的原型。")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Plain Object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foo "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bar "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Object"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPrototypeOf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Not Plain Object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Foobar")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foobar "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Foobar")]),t._v("\n\nconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Object"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPrototypeOf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foobar"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("到這邊其實就是最簡單的 Plain Object 的判斷囉！")]),t._v(" "),e("p",[t._v("這也是 lodash 的實作。")]),t._v(" "),e("p",[t._v("但其實有一些小小得不同，這邊拿出來看看。")]),t._v(" "),e("h4",{attrs:{id:"object-create-null"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#object-create-null","aria-hidden":"true"}},[t._v("#")]),t._v(" "),e("code",[t._v("Object.create(null)")])]),t._v(" "),e("p",[t._v("透過 "),e("code",[t._v("Object.create(null)")]),t._v(" 這個方法能夠做出一個原形為 "),e("code",[t._v("null")]),t._v(" 也就是沒有原型的 "),e("code",[t._v("object")]),t._v("。")]),t._v(" "),e("p",[t._v("常常被用在製作單純的 Key - Value Mapping。")]),t._v(" "),e("p",[t._v("這個方式產生了 object，照我們上面透過 "),e("code",[t._v("Object.getPrototypeOf")]),t._v(" 是無法成為 plain object 的 (因為他的 prototype 不是 Object.prototype 嘛！)。")]),t._v(" "),e("p",[t._v("有趣的是像是 lodash、JQuery 這邊把它當成是 plain object。")]),t._v(" "),e("p",[t._v("但也有一些人寫出來的 "),e("code",[t._v("isPlainObject")]),t._v(" 是把 "),e("code",[t._v("Object.create(null)")]),t._v(" 判斷成 "),e("code",[t._v("false")]),t._v("。")]),t._v(" "),e("p",[t._v("如："),e("a",{attrs:{href:"https://www.npmjs.com/package/is-plain-object",target:"_blank",rel:"noopener noreferrer"}},[t._v("is-plain-object"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("若有用到可能要特別注意一下。")]),t._v(" "),e("h3",{attrs:{id:"透過-object-prototype-tostring-得到-object-tag"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#透過-object-prototype-tostring-得到-object-tag","aria-hidden":"true"}},[t._v("#")]),t._v(" 透過 "),e("code",[t._v("Object.prototype.toString")]),t._v(" 得到 "),e("code",[t._v("[object {tag}]")])]),t._v(" "),e("p",[e("code",[t._v("Object.prototype.toString")]),t._v(" 也就是 "),e("code",[t._v("Vue.js")]),t._v(" 底層函式 "),e("code",[t._v("isPlainObject")]),t._v(" 的用法。")]),t._v(" "),e("p",[t._v("若把 Plain Object 丟進 "),e("code",[t._v("Object.prototype.toString")]),t._v(" 會回傳一個 "),e("code",[t._v("[object Object]")])]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPlainObject")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[object Object]'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPlainObject")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPlainObject")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPlainObject")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Object"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPlainObject")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [object Boolean] false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPlainObject")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [object String] false")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPlainObject")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [object Array] false")]),t._v("\n")])])]),e("p",[t._v("到這邊看許多人都使用 "),e("code",[t._v("Object.prototype.toString")]),t._v(" 來判斷。")]),t._v(" "),e("p",[t._v("那到底為什麼是 "),e("code",[t._v("Object.prototype.toString")]),t._v(" 這個看起來完全和判斷型別八竿子打不著的函數！")]),t._v(" "),e("p",[t._v("到這邊其實直接找 ECMAScript spec 的是最快的")]),t._v(" "),e("blockquote",[e("p",[e("a",{attrs:{href:"https://www.ecma-international.org/ecma-262/10.0/index.html#sec-object.prototype.tostring",target:"_blank",rel:"noopener noreferrer"}},[t._v("19.1.3.6Object.prototype.toString ( )"),e("OutboundLink")],1),t._v(" "),e("img",{attrs:{src:"https://i.imgur.com/aWTNxPL.png",alt:""}})])]),t._v(" "),e("p",[t._v("簡單解釋一下 ecma 定義了什麼\n一起看一下做了什麼事...")]),t._v(" "),e("ol",[e("li",[t._v("undefined 回傳 [object Undefined]")]),t._v(" "),e("li",[t._v("null 回傳 [object Null]")]),t._v(" "),e("li",[t._v("設 O 為  ToObject(this value) "),e("code",[t._v("let O = ToObject(this value)")])]),t._v(" "),e("li",[t._v("透過 "),e("code",[t._v("isArray(O)")]),t._v(" 判斷是 array，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"Array"')])]),t._v(" "),e("li",[t._v("如果 O 是 exotic object, 回傳 String ，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"String"')])]),t._v(" "),e("li",[t._v("如果 O 有 [[ ParameterMap ]], ，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"Arguments"')])]),t._v(" "),e("li",[t._v("如果 O 有 [[ Call ]], ，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"Function"')])]),t._v(" "),e("li",[t._v("如果 O 有 [[ ErrorData ]], ，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"Error"')])]),t._v(" "),e("li",[t._v("如果 O 有 [[ BooleanData ]], ，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"Boolean"')])]),t._v(" "),e("li",[t._v("如果 O 有 [[ NumberData ]], ，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"Number"')])]),t._v(" "),e("li",[t._v("如果 O 有 [[ DateValue ]], ，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"Date"')])]),t._v(" "),e("li",[t._v("如果 O 有 [[ RegExpMatcher ]], ，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"RegExp"')])]),t._v(" "),e("li",[t._v("如果都不是以上，使 "),e("code",[t._v("builtinTag")]),t._v(" 為 "),e("code",[t._v('"Object"')])]),t._v(" "),e("li",[t._v("Get 找看看 O 有沒有 "),e("code",[t._v("@@toStringTag")]),t._v(" 存到 tag 中")]),t._v(" "),e("li",[t._v("如果 Type(tag) 不是 String 則 builtinTag = tag")]),t._v(" "),e("li",[t._v("回傳 string-concatenation "),e("code",[t._v('"[object tag]"')])])]),t._v(" "),e("p",[t._v("其實講了那麼多，"),e("code",[t._v("Object.prototype.toString")]),t._v(" 透過 "),e("code",[t._v("內部")]),t._v(" 的檢查，回傳 [object (型態)]。")]),t._v(" "),e("p",[t._v("其實這樣看下來，上面的 "),e("code",[t._v("13.")]),t._v(" 以前都可以很好理解是在判斷內部的型態，但 "),e("code",[t._v("14.")]),t._v(" 後又是在做什麼呢。")]),t._v(" "),e("p",[t._v("我們可以透過這個 "),e("a",{attrs:{href:"https://tc39.es/ecma262/#table-1",target:"_blank",rel:"noopener noreferrer"}},[t._v("table"),e("OutboundLink")],1),t._v(" 找到其實上面寫的 "),e("code",[t._v("@@toStringTag")]),t._v(" 就是 "),e("code",[t._v("Symbol.toStringTag")]),t._v("。")]),t._v(" "),e("p",[t._v("代表我們可以透過 "),e("code",[t._v("Symbol.toStringTag")]),t._v(" 來變更 "),e("code",[t._v("[object Tag]")]),t._v(" 的結果！")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foo "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nfoo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Symbol"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toStringTag"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'foo'")]),t._v("\n\nconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// '[object foo]'")]),t._v("\n")])])]),e("h4",{attrs:{id:"小結"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#小結","aria-hidden":"true"}},[t._v("#")]),t._v(" 小結")]),t._v(" "),e("ol",[e("li",[e("code",[t._v("typeof(obj) === 'object' && typeof(obj) !== null")]),t._v("  來找到 ObjectLike 的 Object")]),t._v(" "),e("li",[e("code",[t._v("Object.getPrototypeOf(obj) === Object.prototype")]),t._v(" 之類的方式判斷原型是否為 Object.prototype")]),t._v(" "),e("li",[t._v("透過 "),e("code",[t._v("Object.prototype.toString")]),t._v(" 取得 Tag 來判斷 Object")])]),t._v(" "),e("p",[t._v("這邊我們看完了三種基本的 isPlainObject，再來我們可以看看各個大框架的實作啦。")]),t._v(" "),e("h3",{attrs:{id:"各種-library-實作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#各種-library-實作","aria-hidden":"true"}},[t._v("#")]),t._v(" 各種 Library 實作")]),t._v(" "),e("h4",{attrs:{id:"lodash"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lodash","aria-hidden":"true"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://github.com/lodash/lodash/blob/aa1d7d870d9cf84842ee23ff485fd24abf0ed3d1/isPlainObject.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("lodash"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("lodash 看起來就是\n"),e("code",[t._v("1. isObjectLike")]),t._v(" "),e("code",[t._v("2. 原形鍊判斷")]),t._v(" "),e("code",[t._v("3. getTag === [object Object]")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://i.imgur.com/9wTBxZv.png",alt:""}})]),t._v(" "),e("h4",{attrs:{id:"vue"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vue","aria-hidden":"true"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://github.com/lodash/lodash/blob/master/isPlainObject.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("vue 的話就只有用到\n"),e("code",[t._v("3. Object.prototype.toString")])]),t._v(" "),e("h4",{attrs:{id:"jquery"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jquery","aria-hidden":"true"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://github.com/jquery/jquery/blob/4592595b478be979141ce35c693dbc6b65647173/src/core.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("JQuery"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("JQuery 其實在 Document 有定義 Plain Object")]),t._v(" "),e("blockquote",[e("p",[e("img",{attrs:{src:"https://i.imgur.com/qrxx8xO.png",alt:""}})])]),t._v(" "),e("p",[t._v("但我們直接看原始碼\n"),e("img",{attrs:{src:"https://i.imgur.com/YW0mJ48.png",alt:""}}),t._v("\nJQ 這邊前面是用了 "),e("code",[t._v("2.")]),t._v("\n再來額外判斷 prototype 是否為 "),e("code",[t._v("null")]),t._v(" (Object.create(null)) 情境")]),t._v(" "),e("p",[t._v("最後的 "),e("code",[t._v("return Ctor === 'function' && fnToString.call(Ctor) === ObjectFunctionString")]),t._v("，是透過判斷傳入的 object 的 "),e("code",[t._v("constructor")]),t._v(" 是否和 Object 相圖，所以感覺像是變形的 "),e("code",[t._v("2.")]),t._v(" 吧。")]),t._v(" "),e("p",[t._v("話外題： JQuery 的 "),e("code",[t._v("ObjectFunctionString")]),t._v("，可以去追蹤一下過程，感覺滿神奇的XD (默默踩到另外一個水坑)")]),t._v(" "),e("h3",{attrs:{id:"redux"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redux","aria-hidden":"true"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://github.com/reduxjs/redux/blob/9d3273846aa8906d38890c410b62fb09a4992018/src/utils/isPlainObject.ts",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redux"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("基本上是採取 "),e("code",[t._v("1.")]),t._v(" + "),e("code",[t._v("2.")]),t._v("\n但這邊有一些有趣的討論可以看看～https://www.zhihu.com/question/299783862")]),t._v(" "),e("h2",{attrs:{id:"結論"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#結論","aria-hidden":"true"}},[t._v("#")]),t._v(" 結論")]),t._v(" "),e("p",[t._v("Javascript Plain Object 基本上來說就是透過 "),e("code",[t._v("new Object")]),t._v(" 或是 "),e("code",[t._v("{}")]),t._v(" 定義出來的物件。")]),t._v(" "),e("p",[t._v("但各個框架的實作可能略有差異，若被雷到請詳細閱讀原始碼 XD")]),t._v(" "),e("h3",{attrs:{id:"參考資料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#參考資料","aria-hidden":"true"}},[t._v("#")]),t._v(" 參考資料")]),t._v(" "),e("blockquote",[e("p",[t._v("stackoverflow isplainobject-thing\nhttps://stackoverflow.com/questions/18531624/isplainobject-thing\nECMAScript")])])],2)}),[],!1,null,null,null);a.default=n.exports}}]);